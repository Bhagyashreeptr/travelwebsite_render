<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book Flight & Hotel</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(to right, #74ebd5, #ACB6E5); min-height:100vh; display:flex; align-items:center; justify-content:center; padding:30px; }
    form { background:#fff; padding:30px; border-radius:20px; width:100%; max-width:500px; box-shadow:0 10px 25px rgba(0,0,0,0.2);}
    label { font-weight:600; margin-top:10px; display:block; }
    input, select { width:100%; padding:12px; margin:8px 0 15px 0; border-radius:10px; border:1px solid #ccc; transition:0.3s;}
    input:focus, select:focus { border-color:#28a745; box-shadow:0 0 5px rgba(40,167,69,0.5); outline:none;}
    input[readonly]{background:#f0f0f0; cursor:not-allowed;}
    button { background:#28a745; color:white; padding:15px; border:none; border-radius:50px; cursor:pointer; font-size:16px; width:100%; transition:0.3s;}
    button:hover{background:#218838; box-shadow:0 5px 15px rgba(0,0,0,0.2);}
</style>
</head>
<body>
<form method="POST">
    <h1><i class="fa-solid fa-plane-departure"></i> Book Your Flight & Hotel</h1>

    <label>Full Name</label>
    <input type="text" name="name" pattern="[A-Za-z ]+" title="Only alphabets allowed" required>

    <label>Email</label>
    <input type="email" name="email" pattern="[a-zA-Z0-9._%+-]+@gmail\.com" title="Must be a valid Gmail address" required>

    <label>Phone</label>
    <div style="display:flex; gap:10px;">
        <select name="country_code" required style="flex:1;">
            <option value="+91">+91 (India)</option>
            <option value="+1">+1 (USA)</option>
            <option value="+44">+44 (UK)</option>
        </select>
        <input type="text" name="phone" pattern="[0-9]{10}" maxlength="10" title="Must be 10 digits" required style="flex:2;">
    </div>

    <label>Choose Flight</label>
    <select name="flight" id="flightSelect" required>
        <option value="">-- Select Flight --</option>
        {% for flight in flights %}
        <option value="{{ flight.id }}" data-destination="{{ flight.destination }}" data-price="{{ flight.price }}">
            {{ flight.name }} ({{ flight.source }} â†’ {{ flight.destination }}) - ${{ flight.price }}
        </option>
        {% endfor %}
    </select>

    <label>Choose Hotel</label>
    <select name="hotel" id="hotelSelect" required>
        <option value="">-- Select Hotel --</option>
        {% for hotel in hotels %}
        <option value="{{ hotel.id }}" data-location="{{ hotel.location }}" data-price="{{ hotel.price }}">
            {{ hotel.name }} - {{ hotel.location }} - ${{ hotel.price }}
        </option>
        {% endfor %}
    </select>

    <label>Total Price</label>
    <input type="text" id="totalPrice" value="$0" readonly>

    <label>Payment Method</label>
    <select name="payment" required>
        <option value="">-- Select Payment Method --</option>
        <option value="UPI">UPI</option>
        <option value="Credit Card">Credit Card</option>
        <option value="Debit Card">Debit Card</option>
        <option value="Net Banking">Net Banking</option>
    </select>

    <button type="submit"><i class="fa-solid fa-check"></i> Book Now</button>
</form>

<script>
const flightSelect = document.getElementById("flightSelect");
const hotelSelect = document.getElementById("hotelSelect");
const totalPriceInput = document.getElementById("totalPrice");
const allHotels = Array.from(hotelSelect.options);

function updateTotalPrice(){
    const selectedFlight = flightSelect.options[flightSelect.selectedIndex];
    const selectedHotel = hotelSelect.options[hotelSelect.selectedIndex];
    let flightPrice = selectedFlight ? parseFloat(selectedFlight.getAttribute("data-price")) || 0 : 0;
    let hotelPrice = selectedHotel ? parseFloat(selectedHotel.getAttribute("data-price")) || 0 : 0;
    totalPriceInput.value = "$" + (flightPrice + hotelPrice);
}

flightSelect.addEventListener("change", function(){
    const selectedFlight = flightSelect.options[flightSelect.selectedIndex];
    const destination = selectedFlight.getAttribute("data-destination");
    hotelSelect.innerHTML = '<option value="">-- Select Hotel --</option>';
    allHotels.forEach(hotel=>{
        if(hotel.getAttribute("data-location")===destination){
            hotelSelect.appendChild(hotel.cloneNode(true));
        }
    });
    updateTotalPrice();
});

hotelSelect.addEventListener("change", updateTotalPrice);
</script>
</body>
</html>
